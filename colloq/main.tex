\documentclass[10pt]{beamer}

\usepackage[utf8]{inputenc}

\usetheme[progressbar=frametitle]{metropolis}
\usepackage{appendixnumberbeamer}
\usepackage{tikz}
\usepackage{tikzpeople}
\usetikzlibrary{shapes,fit}
\usepackage{xcolor}

\usepackage{pstricks}
\usepackage[operators,sets]{cryptocode}

\setbeameroption{hide notes} % Only slides
%\setbeameroption{show only notes} % Only notes
%\setbeameroption{show notes on second screen=right} % Both

\usepackage{amsmath}

\usepackage{booktabs}
\usepackage[scale=2]{ccicons}

\usepackage{environ}

\usepackage{listings}

\usepackage{pgfplots}
\usepgfplotslibrary{dateplot}

%rectangles around nodes
\usetikzlibrary{calc}

%right of=30mm of X
\usetikzlibrary{positioning}

\usepackage{xspace}
\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}

\usepackage{hyperref}


\title{Secure Steganography on ML-Based Channels}
\date{2022-11-11}
\author{Jeremy Boy}
\institute{Universität zu Lübeck}
% \titlegraphic{\hfill\includegraphics[height=1.5cm]{logo.pdf}}

\newsavebox\myboxa
\newsavebox\myboxb
\newlength\myhta
\newlength\mydpa
\newlength\myhtb
\newlength\mydpb
\newlength\maxht

\newcommand\CCCcolumns[3]{%
\begin{lrbox}{\myboxa}
  \begin{minipage}{0.3\linewidth}
  #1
  \end{minipage}%
\end{lrbox}%
\begin{lrbox}{\myboxb}
  \begin{minipage}{0.3\linewidth}
  #3
  \end{minipage}%
\end{lrbox}% 
\settoheight\myhta{\usebox\myboxa}%
\settodepth\mydpa{\usebox\myboxa}%
\addtolength\myhta{\mydpa}%
\settoheight\myhtb{\usebox\myboxb}%
\settodepth\mydpb{\usebox\myboxb}%
\addtolength\myhtb{\mydpb}%
\setlength\maxht{\myhta}%
\ifdim\myhtb>\myhta
  \setlength\maxht{\myhtb}%
\fi
\begin{minipage}[t][\maxht][c]{0.45\linewidth}
  #1
\end{minipage}\hfill
\begin{minipage}[t][\maxht][c]{0.1\linewidth}
  #2
\end{minipage}\hfill
\begin{minipage}[t][\maxht][c]{0.45\linewidth}
  #3
\end{minipage}%
}

\AtBeginSection{\frame{\sectionpage}}
%\AtBeginSection{}
%\AtBeginSubsection{\frame{\subsectionpage}}

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

\makeatletter
\newsavebox{\measure@tikzpicture}
\NewEnviron{scaletikzpicturetowidth}[1]{%
  \def\tikz@width{#1}%
  \def\tikzscale{1}\begin{lrbox}{\measure@tikzpicture}%
  \BODY
  \end{lrbox}%
  \pgfmathparse{#1/\wd\measure@tikzpicture}%
  \edef\tikzscale{\pgfmathresult}%
  \BODY
}
\makeatother


\newcommand\Vtextvisiblespace[1][.3em]{%
  \mbox{\kern.06em\vrule height.3ex}%
  \vbox{\hrule width#1}%
  \hbox{\vrule height.3ex}}

\begin{document}

\maketitle

\begin{frame}{Contents}
  \setbeamertemplate{section in toc}[sections numbered]
  \tableofcontents[hideallsubsections]
\end{frame}

\section{Improving the Reliability of the Meteor Stegosystem}

\begin{frame}{Improving the Reliability of the Meteor Stegosystem}
	\begin{itemize}[<+- | alert@+>]
		\item \textbf{Tokens} used in generative models are \textbf{not prefix-free}.
		\item Example: GPT-2 has tokens for ``hel'', ``lo'', and ``hello''.
		\item This causes decoding failures, hence \textbf{unreliability}.
	\end{itemize}
\end{frame}

\begin{frame}{Improving the Reliability of the Meteor Stegosystem}
	\begin{center}
		\textbf{Example: Failed Decoding}
	\end{center}
\end{frame}

\begin{frame}{Improving the Reliability of the Meteor Stegosystem}
	\begin{itemize}[<+- | alert@+>]
		\item \textbf{How often} does this happen?
		\item \textbf{Experiment:} Encode Hamlet in blocks of 128 and 1024 bytes
		\item Calculate \textbf{tokenization distance} $D$
		\item Random variable $X = D(T_A(c), T_B(c))$
		\item If distance greater than zero: \textbf{decoding failure}
	\end{itemize}
\end{frame}

\begin{frame}{Improving the Reliability of the Meteor Stegosystem}
	\centering
	\input{../tex/fig_meteor_stats_mismatch_count_128.tikz}
	$$\hat{Pr}_{128}[X=0] \approx 0.57$$
\end{frame}

\begin{frame}{Improving the Reliability of the Meteor Stegosystem}
	\centering
	\input{../tex/fig_meteor_stats_mismatch_count_1024.tikz}
	$$\hat{Pr}_{1024}[X=0] \approx 0.13$$
\end{frame}

\begin{frame}{Improving the Reliability of the Meteor Stegosystem}
	\begin{itemize}[<+- | alert@+>]
		\item \textbf{Can we recover} from decoding failures? 
		\item Good news: Yes, we can!
		\item Bad news: \textbf{exponential computational overhead} (potentially).
	\end{itemize}
\end{frame}

\begin{frame}{Improving the Reliability of the Meteor Stegosystem}
	\begin{itemize}[<+- | alert@+>]
		\item A: \textbf{split hiddentext} into blocks of size $\gamma$, add \textbf{checksums} of size $\delta$.
		\item B: \textbf{verify checksums} while decoding $c$.
		\item If \textbf{verification fails}, a tokenization mismatch occurred.
		\item Generate \textbf{tokenization graph} $G=(V,E)$ of $c$.
		\item Find all paths in $G$ and \textbf{retry with a random path}.
	\end{itemize}
\end{frame}
	
\begin{frame}{Improving the Reliability of the Meteor Stegosystem}
  \centering
  \begin{tikzpicture}
    \node[rectangle, draw=black] (hello) {hello};
    \node[rectangle, draw=black, right=15mm of hello] (lo) {lo};
    \node[rectangle, draw=black, above=15mm of lo] (llo) {llo};
    \node[rectangle, draw=black, above=15mm of llo] (ello) {ello};
    \node[rectangle, draw=black, below=15mm of lo] (o) {o};
    \node[rectangle, draw=black, right=15mm of lo] (bot) {$\epsilon$};
    
    \draw[->] (hello) to node[above] {h} (ello);
    \draw[->] (hello) to node[above] {he} (llo);
    \draw[->] (hello) to node[above] {hel} (lo);
    \draw[->] (hello) to node[left] {hell} (o);
    \draw[->, bend right=90,looseness=2] (hello) to node[below] {hello} (bot);

    \draw[->] (ello) to node[right] {e} (llo);
    %\draw[->, bend left=30] (ello) to node[right] {el} (lo);
    %\draw[->, bend left=30] (ello) to node[above] {ell} (o);
    \draw[->] (ello) to node[right] {ello} (bot);

    \draw[->] (llo) to node[right] {l} (lo);
    %\draw[->, bend right=30] (llo) to node[above] {ll} (o);
    %\draw[->] (llo)   to node[above] {llo} (bot);

    \draw[->] (lo)    to node[right] {l} (o);
    \draw[->] (lo)    to node[above] {lo} (bot);

    \draw[->] (o)     to node[above] {o} (bot);
  \end{tikzpicture}
\end{frame}


\section{Adapting the Meteor Stegosystem for Two-Way Communication}

\begin{frame}{Meteor One-Way (Example with GPT-2)}
	\centering
	\includegraphics[height=0.9\textheight]{twoway_no_split.png}
\end{frame}


\begin{frame}{Meteor Conversation (Example with GPT-2)}
	\centering
	\includegraphics[height=0.9\textheight]{twoway_gpt.png}
\end{frame}

\begin{frame}{Meteor Conversation (Example with DialoGPT)}
	\centering
	\includegraphics[height=0.9\textheight]{twoway_dialogpt.png}
\end{frame}

\section{Improving the Security of the Meteor Stegosystem}

\begin{frame}{Improving the Security of the Meteor Stegosystem}
	\begin{itemize}[<+- | alert@+>]
		\item \textbf{SS-CHA security} by reduction to PRG.
		\item Meteor's implementation is \textbf{deterministic}.
		\item \textbf{Secure} against CHA with query complexity one.
		\item \textbf{Insecure} against CHA with higher query complexity.
		\item \textbf{Improve security with SES-CTR} to randomize outputs.
	\end{itemize}
\end{frame}

\section{Conclusion}

\begin{frame}{Conclusion}
    \begin{itemize}[<+- | alert@+>]
        \item \textbf{Generative models} can be used to build \textbf{secure stegosystems}
        \item Ambiguous tokenization causes \textbf{computational overhead}
        \item Meteor is \textbf{easily adaptable} to different models (DialoGPT)
        \item We can \textbf{improve security} by replacing cryptographic primitive
        \item \textbf{Stegotext quality} and \textbf{ML performance} are improving
    \end{itemize}
    \centering
    \only<5>{\begin{tabular}{l||c|c|c|c}
	    Model & GPU (sec) & CPU (sec) & Rate (bits/token) \\
	    \hline
	    GPT-2        & 13.089 & 82.214  & 3.09 \\
	    Wikipedia    & 19.791 & 46.583  & 0.64 \\
	    HTTP Headers & 49.380 & 103.280 & 0.21 \\
	  \end{tabular}}
\end{frame}
    
\end{document}